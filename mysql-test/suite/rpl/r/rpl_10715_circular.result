include/rpl_init.inc [topology=1->2,2->1]
stop slave;
change master to master_use_gtid=current_pos;
start slave;
stop slave;
change master to master_use_gtid=current_pos;
start slave;
#server 1
create table t1(a int , b int, c int);
insert into t1 values(1,1,1);
select @@gtid_binlog_state;
@@gtid_binlog_state
1-1-2
#server 2
insert into t1 values(2,2,1);
select @@gtid_binlog_state;
@@gtid_binlog_state
1-1-2,2-2-1
#server 1
insert into t1 values(1,1,2);
select @@gtid_binlog_state;
@@gtid_binlog_state
1-1-3,2-2-1
set @@session.server_id=99;
insert into t1 values(1,99,4);
#server 2
insert into t1 values(2,2,2);
select @@gtid_binlog_state;
@@gtid_binlog_state
1-1-3,1-99-4,2-2-2
#server 1
select * from t1;
a	b	c
1	1	1
2	2	1
1	1	2
1	99	4
1	99	4
2	2	2
select @@gtid_binlog_state;
@@gtid_binlog_state
1-1-3,1-99-4,2-2-2
#server 2
select * from t1;
a	b	c
1	1	1
2	2	1
1	1	2
1	99	4
2	2	2
select @@gtid_binlog_state;
@@gtid_binlog_state
1-1-3,1-99-4,2-2-2
drop table t1;
include/rpl_end.inc
